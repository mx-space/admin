(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b4201fa"],{"0b97":function(t,e,i){},"3aab":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("PageLayout",{attrs:{options:t.options},scopedSlots:t._u([{key:"header",fn:function(){return[i("Button",{attrs:{icon:["fab","telegram-plane"],name:t.$route.query.id?"更新":"发布"},nativeOn:{click:function(e){return t.handleSubmit(e)}}})]},proxy:!0},{key:"footer",fn:function(){return[i("button",{on:{click:t.handleDrawerOpen}},[i("icon",{attrs:{icon:["fas","sliders-h"]}})],1)]},proxy:!0}])},[i("Writer",{ref:"writer",attrs:{name:t.inputLabel,title:t.model.title,text:t.model.text,id:t.id||"post"},on:{change:t.onChange}},[i("div",{staticClass:"url"},[i("label",{staticClass:"prefix"},[t._v(t._s(t.baseUrl+"/"+t.category.slug+"/"))]),i("UInput",{attrs:{value:t.slug},on:{change:function(e){return t.slug=e}}})],1)]),i("el-drawer",{staticClass:"drawer",attrs:{title:"文章设定",direction:"rtl",visible:t.drawerOpen},on:{"update:visible":function(e){t.drawerOpen=e}}},[i("el-form",{attrs:{model:t.model,"label-width":"80px","label-position":"top"}},[i("el-form-item",{attrs:{label:"分类"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.categoryId,callback:function(e){t.categoryId=e},expression:"categoryId"}},t._l(t.categoryRecord,(function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t._id}})})),1)],1),i("el-form-item",{attrs:{label:"标签"}},[t._l(t.tags,(function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleClose(e)}}},[t._v(" "+t._s(e)+" ")])})),t.inputVisible?i("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small","fetch-suggestions":t.querySearch},on:{select:t.handleSelect},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.newTagValue,callback:function(e){t.newTagValue=e},expression:"newTagValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新标签")])],2),i("el-form-item",{attrs:{label:"概要"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入概要(Option)"},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}})],1)],1),i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"隐藏?"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.hide,callback:function(e){t.hide=e},expression:"hide"}})],1),i("el-form-item",{attrs:{label:"Copyright?"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.copyright,callback:function(e){t.copyright=e},expression:"copyright"}})],1)],1)],1)],1)},s=[]},"3ee0":function(t,e,i){"use strict";i.r(e);var a=i("fb3a"),s=i.n(a);for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);e["default"]=s.a},"45eb":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"root",staticClass:"layout"},[i("div",{staticClass:"toggle",class:{active:t.sidebar},on:{click:t.toggleSidebarStatus}},[i("icon",{attrs:{icon:["fas","sliders-h"]}})],1),i("header",{style:t.options.noPadding?"padding: 0.5rem 0;":""},[i("span",{staticClass:"title"},[t._v(t._s(t.options.title?t.options.title:t.$route.meta.title))]),t.$slots.header?i("div",{staticClass:"btn-container"},[t._t("header")],2):t._e()]),i("main",{on:{click:function(e){return t.setSidebarStatus(!1)}}},[t._t("default"),i("div",{staticClass:"end-center"},[t._t("end")],2)],2),i("footer",[i("div",{staticClass:"float-btns"},[t._t("footer")],2)])])},s=[],r=i("2f62"),n={computed:{...Object(r["mapGetters"])(["sidebar"])},methods:{...Object(r["mapActions"])("app",["toggleSidebarStatus","setSidebarStatus"])},props:{options:{type:Object,default(){return{}}}},provide(){return{toTop:()=>{this.$refs.root.scrollTo({left:0,top:0,behavior:"smooth"})}}}},o=n,l=(i("769a"),i("2877")),u=Object(l["a"])(o,a,s,!1,null,"7e5779a4",null);e["default"]=u.exports},6552:function(t,e,i){"use strict";var a=i("cb17"),s=i.n(a);s.a},7118:function(t,e,i){"use strict";var a=i("8b3a"),s=i.n(a);s.a},"769a":function(t,e,i){"use strict";var a=i("0b97"),s=i.n(a);s.a},"8b3a":function(t,e,i){},cb17:function(t,e,i){},d114:function(t,e,i){"use strict";var a=i("ee15"),s=i.n(a);s.a},d7b7:function(t,e,i){"use strict";i.r(e);var a=i("3aab"),s=i("3ee0");for(var r in s)"default"!==r&&function(t){i.d(e,t,(function(){return s[t]}))}(r);i("7118"),i("d114"),i("6552");var n=i("2877"),o=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"18987e07",null);e["default"]=o.exports},ee15:function(t,e,i){},fb3a:function(t,e,i){"use strict";i("ddb0"),Object.defineProperty(e,"__esModule",{value:!0});const a=i("9ab4"),s=a.__importDefault(i("2fe1")),r=i("60a3"),n=a.__importDefault(i("71ac")),o=a.__importDefault(i("45eb")),l=a.__importStar(i("13cf")),u=a.__importDefault(i("8eab")),c=i("4bb5");let d=class extends(r.Mixins(l.BaseWriter)){constructor(){super(...arguments),this.options={title:""},this.inputLabel="想想取个什么题目比较好呢~",this.model={title:"",text:""},this.drawerOpen=!1,this.categoryId="",this.categoryRecord={},this.timer=null,this.allExistTags=[],this.inputVisible=!1,this.newTagValue="",this.slug="",this.summary="",this.hide=!1,this.copyright=!0,this.prefix="mx-space-post",this.tags=[]}handleDrawerOpen(){return a.__awaiter(this,void 0,void 0,(function*(){this.drawerOpen=!this.drawerOpen;const{data:t}=yield this.$api("Category").get(void 0,{params:{type:"Tag"}});this.allExistTags=t.map(t=>({value:t.name}))}))}handleSelect(){return a.__awaiter(this,void 0,void 0,(function*(){this.handleInputConfirm()}))}handleSubmit(){return a.__awaiter(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},this.model),{slug:this.slug,categoryId:this.category._id,summary:""===this.summary?void 0:this.summary,hide:this.hide,copyright:this.copyright,tags:this.tags||[]});this.id?yield this.$api("Post").update(this.id,t):yield this.$api("Post").post(t),this.AfterSubmit(),this.$router.push("/posts")}))}onChange(t){this.model=Object.assign({},t)}get baseUrl(){return"https://innei.ren"}get category(){const t=this.categories.get(this.categoryId)||{slug:"",name:""};return{_id:this.categoryId,slug:t.slug,name:t.name}}setDefaultCategory(){var t;const e=[...this.categories.entries()];if(this.categoryRecord=Object.fromEntries(e),this.categoryId)return!0;const i=null===(t=e.shift())||void 0===t?void 0:t[1];return!!i&&(this.categoryId=i._id,!0)}mounted(){this.categoryId||(this.timer=setInterval(()=>{const t=this.setDefaultCategory();t&&(clearInterval(this.timer),this.timer=null)},100))}beforeDestroy(){clearInterval(this.timer),this.timer=null}created(){var t;return a.__awaiter(this,void 0,void 0,(function*(){if(this.options.title=this.id?"修改文章":"撰写新文章",this.id){const{data:e}=yield this.$api("Post").get(this.$route.query.id);this.slug=e.slug,this.summary=null!==(t=e.summary)&&void 0!==t?t:"",this.model={title:e.title,text:e.text},this.hide=e.hide,this.categoryId=e.categoryId,this.tags=e.tags||[]}}))}showInput(){this.inputVisible=!0,this.$nextTick(()=>{this.$refs.saveTagInput.$refs.input.focus()})}querySearch(t,e){return a.__awaiter(this,void 0,void 0,(function*(){const i=this.allExistTags,a=t?i.filter(this.createFilter(t)):i;e(a)}))}createFilter(t){return e=>0===e.value.toLowerCase().indexOf(t.toLowerCase())}handleClose(t){this.tags.splice(this.tags.indexOf(t),1)}handleInputConfirm(){const t=this.newTagValue;t&&!this.tags.includes(t)&&this.tags.push(t),this.inputVisible=!1,this.newTagValue=""}};a.__decorate([c.Getter],d.prototype,"categories",void 0),d=a.__decorate([s.default({components:{Button:n.default,PageLayout:o.default,Writer:l.default,UInput:u.default}})],d),e.default=d}}]);